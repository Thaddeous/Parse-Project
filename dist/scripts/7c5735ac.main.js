"use strict";function previewImage(a){var b=new FileReader;b.onload=function(a){var b=a.target.result;$(".placeholder").attr("src",b)},b.readAsDataURL(a.files[0])}Parse.initialize("lxTMGChjTMuMPw4K8CII2dbFToa07o2ZI0hQrenq","qtlcgfkOE8dHec9aZ8Z5Eko394uYd9x5twNB3Iv8");var Photo=Parse.Object.extend({className:"Photo",defaults:{username:"No Username",caption:"Missing Description",file:"Blank URL"}}),Photos=Parse.Collection.extend({model:Photo}),PhotoInstanceView=Parse.View.extend({className:"photo-Instance-View",template:_.template($(".photo-instance-template").text()),events:{},initialize:function(){$(".main-photo-block").append(this.el),this.render(),console.log("photoinstanceview this.model.attributes",this.model.attributes)},render:function(){var a=this.template(this.model.attributes);this.$el.html(a)}}),AppView=Parse.View.extend({className:"app-View",events:{},initialize:function(){$(".main-photo-block").append(this.el),this.collection=new Photos,this.collection.on("add",function(a){new PhotoInstanceView({model:a})}),this.collection.fetch({add:!0})}}),UploadView=Parse.View.extend({className:"upload-View",template:_.template($(".upload-template").text()),events:{"click .file-upload":"addInfo","change .file-uploader":"previewPic"},initialize:function(){console.log("initialize upload view is working"),$(".upload-main").html("").append(this.el),this.render()},render:function(){console.log("its working");var a=this.template;this.$el.append(a)},addInfo:function(){console.log("addInfo is working");var a=$(".file-uploader")[0];if(a.files.length>0)var b=a.files[0],c="photo.jpg",d=new Parse.File(c,b);var e=this;d.save().done(function(){console.log("The file has been saved!");var a=new Photo;console.log(e.$el);var b=e.$el.find(".caption-field").val();a.set("caption",b),a.set("file",d),a.save(),appView.collection.add(a),uploadView.remove(),$(".upload-main").removeClass("activated"),$(".main-photo-block").removeClass("activated")},function(){console.log("Something went wrong in the upload process dude.")})},placeholder:function(){var a=Photo.get("file");$(".placeholder").attr("src",a.url())},previewPic:function(){var a=$(".file-uploader")[0];previewImage(a)}}),photoInstanceView,appView,uploadView;$(".plus").click(function(){$(".upload-main").addClass("activated"),$(".main-photo-block").addClass("activated"),uploadView=new UploadView});var AppRouter=Parse.Router.extend({routes:{"":"home",upload:"upload"},home:function(){console.log("The Home View has loaded."),appView=new AppView},upload:function(){console.log("The Upload View had loaded."),uploadView=new UploadView}});new AppRouter,Parse.history.start();